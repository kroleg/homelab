extends ../layout

block content
  .d-flex.justify-content-between.align-items-center.mb-4
    h4 DNS Logs (Last 1000 Requests)
    a.btn.btn-primary(href='http://grafana.internal/d/dns-proxy-metrics' target='_blank') Grafana Dashboard

  if stats
    .row.mb-4
      .col-md-3
        .card.text-center
          .card-body
            h5.card-title Total
            p.card-text.h3= stats.total_requests || 0
      .col-md-3
        a.text-decoration-none(href='/logs/resolved')
          .card.text-center.border-success
            .card-body
              h5.card-title.text-success Resolved
              p.card-text.h3= stats.resolved_count || 0
              if stats.resolved_count > 0
                small.text-muted View details
      .col-md-2
        a.text-decoration-none(href='/logs/failed/7d')
          .card.text-center.border-danger
            .card-body
              h5.card-title.text-danger Failed
              p.card-text.h3= stats.failed_count || 0
              if stats.failed_count > 0
                small.text-muted View details
      .col-md-2
        a.text-decoration-none(href='/logs/blocked')
          .card.text-center.border-warning
            .card-body
              h5.card-title.text-warning Blocked
              p.card-text.h3= stats.blocked_count || 0
              if stats.blocked_count > 0
                small.text-muted View details
      .col-md-2
        .card.text-center.border-info
          .card-body
            h5.card-title.text-info Avg Response
            p.card-text.h3= stats.avg_response_time ? Math.round(stats.avg_response_time) + 'ms' : '-'

  .card
    .card-header
      h5 Connected Clients
    .card-body
      if clients.length === 0
        p.text-muted No clients currently connected.
      else
        .list-group
          each client in clients
            a.list-group-item.list-group-item-action(href=`/logs/${client.ip}`)= client.name
