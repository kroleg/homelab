extends ../layout

block content
  .d-flex.justify-content-between.align-items-center.mb-4
    h2 Blocked DNS Requests
    div
      a.btn.btn-outline-primary.me-2(href='http://grafana.internal/d/dns-proxy-metrics' target='_blank') Grafana
      a.btn.btn-secondary(href='/logs') Back to Logs

  if requests.length === 0
    p.text-muted No blocked requests found.
  else
    .table-responsive
      table.table.table-striped.table-hover
        thead
          tr
            th Timestamp
            th Client IP
            th Hostname
            th Response Time
        tbody
          each request in requests
            tr
              td= new Date(request.created_at).toLocaleString()
              td
                a(href=`/logs/${request.client_ip}`)= request.client_ip
              td.text-warning= request.hostname
              td= request.response_time_ms ? request.response_time_ms + 'ms' : '-'

    if pagination && pagination.totalPages > 1
      nav.mt-3(aria-label='Page navigation')
        ul.pagination.justify-content-center
          li.page-item(class=pagination.page === 1 ? 'disabled' : '')
            a.page-link(href=`?page=${pagination.page - 1}`) Previous

          - for (let i = 1; i <= pagination.totalPages; i++)
            li.page-item(class=i === pagination.page ? 'active' : '')
              a.page-link(href=`?page=${i}`)= i

          li.page-item(class=pagination.page === pagination.totalPages ? 'disabled' : '')
            a.page-link(href=`?page=${pagination.page + 1}`) Next

  p.text-muted.mt-4
    | Showing #{requests.length} of #{pagination.total} blocked requests (last 1000 in memory)
    if pagination.totalPages > 1
      |  (Page #{pagination.page} of #{pagination.totalPages})
